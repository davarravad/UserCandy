# UserCandy Framework

UserCandy is a simple PHP/MySQL website framework. It provides a basic login system, routing, and default pages that can be customized without modifying the core.

## Requirements
- PHP 7.4+
- MySQL

## Installation
1. Copy `app/default-config.php` to `app/config.php` and update your database credentials and OAuth settings.
2. Create a MySQL database and run the following to create the users table:
   ```sql
   CREATE TABLE users (
     id INT AUTO_INCREMENT PRIMARY KEY,
     email VARCHAR(255) UNIQUE NOT NULL,
     password VARCHAR(255) NOT NULL,
     role ENUM('guest','member','staff','admin') NOT NULL DEFAULT 'member',
     avatar VARCHAR(255) DEFAULT NULL
   );
   ```
3. Serve the `public` directory as your web root so requests are handled by `public/index.php`.

If `app/config.php` is missing, the framework will display a setup message instead of crashing.

## Customization
Add or modify pages in the `app/pages` directory. Files in this folder override files in `pages` with the same name, allowing upgrades without overwriting custom code.
The templates in the `templates` directory load a header and footer using Tailwind CSS for styling.
The footer text and other common labels come from the language files so they can be translated easily.

## OAuth Login
Enable Google, Discord, or Windows login by setting the appropriate flags and credentials in `app/config.php`.
You may also enable Google reCAPTCHA on the login and registration forms by
setting `enable_recaptcha` to `true` and providing your site and secret keys.

## Default Pages
- `/` – Home
- `/login` – Login page
- `/register` – Registration page
- `/dashboard` – Protected user dashboard
- `/profile/{id}` – Public user profile by ID

Enjoy building with UserCandy!

## Interface Features
- **Navigation bar** with sample links, user menu and notification bell.
- **Popup notifications** using `showPopup(message, type)` where `type` is `success` or `error`.
- **Light/Dark theme toggle** via the sun/moon button in the nav bar.
- **Notification system**. Use `add_notification($title, $url)` in PHP to queue a notice for the current user. When the user follows the generated link the notice is automatically marked as read.
- **Language files** in `languages/` allow easy translation of common text. Set the default language in `config.php`.
- **Footer text** is also loaded from the language files.

### Using the notification helper
In any PHP page after `core/init.php` has been included, call:

```php
add_notification('Check this page', base_url('some/page'));
```

The notification will appear in the bell menu for the current user. Links generated by `add_notification` automatically append a `notify` parameter so that visiting the page marks it as read.

## Roles and Access Control
Users can have one of four roles: `guest`, `member`, `staff` or `admin`. The
`role` field is stored on the `users` table. To protect a page you can call
`require_role($role)` after including `core/auth.php`:

```php
<?php
require_once __DIR__ . '/../core/auth.php';
require_role('staff');
```

Pass a single role or an array of allowed roles. Unauthorised visitors will be
redirected or see a 403 error.

## AJAX User Table
An example dynamic table is available at `/users`. It loads data with jQuery and allows inline editing by double-clicking cells. Edits are saved automatically.
